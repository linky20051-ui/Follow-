<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Automation System</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Arial; }
        body { background: #0f0f23; color: #00ff00; padding: 10px; font-size: 14px; }
        .terminal { background: #000; border: 2px solid #00ff00; border-radius: 10px; padding: 15px; }
        .header { text-align: center; margin-bottom: 20px; color: #ff00ff; }
        .tab-container { display: flex; margin-bottom: 20px; border-bottom: 1px solid #00ff00; }
        .tab { padding: 10px 20px; cursor: pointer; border: 1px solid transparent; }
        .tab.active { border: 1px solid #00ff00; border-bottom: none; background: #000; }
        .panel { display: none; padding: 20px; background: #111; border-radius: 5px; }
        .panel.active { display: block; }
        input, textarea, select { 
            width: 100%; 
            padding: 10px; 
            margin: 10px 0; 
            background: #222; 
            border: 1px solid #00ff00; 
            color: #00ff00; 
            border-radius: 5px;
        }
        button { 
            background: #0088cc; 
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px;
            font-weight: bold;
        }
        button:hover { background: #0055aa; }
        .btn-danger { background: #cc0000; }
        .btn-success { background: #00aa00; }
        .log { 
            background: #000; 
            padding: 15px; 
            border: 1px solid #00ff00; 
            border-radius: 5px; 
            height: 300px; 
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .log-line { margin: 5px 0; padding: 3px; }
        .success { color: #00ff00; }
        .error { color: #ff0000; }
        .warning { color: #ffff00; }
        .info { color: #0088ff; }
        .accounts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; }
        .account-card { background: #1a1a1a; padding: 15px; border-radius: 8px; border: 1px solid #333; }
        .status-indicator { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .status-active { background: #00ff00; }
        .status-inactive { background: #ff0000; }
        .stats { display: flex; justify-content: space-around; margin: 20px 0; }
        .stat-box { background: #1a1a1a; padding: 15px; border-radius: 8px; text-align: center; }
    </style>
</head>
<body>
    <div class="terminal">
        <div class="header">
            <h1>‚ö° Instagram Automation System v2.0</h1>
            <p>Advanced Multi-Account Management</p>
        </div>

        <div class="tab-container">
            <div class="tab active" onclick="showPanel('dashboard')">üìä Dashboard</div>
            <div class="tab" onclick="showPanel('accounts')">üë• Accounts</div>
            <div class="tab" onclick="showPanel('actions')">‚öôÔ∏è Actions</div>
            <div class="tab" onclick="showPanel('scheduler')">üìÖ Scheduler</div>
            <div class="tab" onclick="showPanel('proxies')">üîó Proxies</div>
            <div class="tab" onclick="showPanel('settings')">‚öôÔ∏è Settings</div>
        </div>

        <!-- Dashboard Panel -->
        <div id="dashboard" class="panel active">
            <div class="stats">
                <div class="stat-box">
                    <h3>Total Accounts</h3>
                    <p id="totalAccounts">0</p>
                </div>
                <div class="stat-box">
                    <h3>Active</h3>
                    <p id="activeAccounts">0</p>
                </div>
                <div class="stat-box">
                    <h3>Today Actions</h3>
                    <p id="todayActions">0</p>
                </div>
                <div class="stat-box">
                    <h3>Success Rate</h3>
                    <p id="successRate">0%</p>
                </div>
            </div>

            <div class="log">
                <h3>System Logs</h3>
                <div id="systemLogs">
                    <!-- Logs will appear here -->
                </div>
            </div>
        </div>

        <!-- Accounts Panel -->
        <div id="accounts" class="panel">
            <h2>Account Management</h2>
            <div>
                <input type="text" id="accUsername" placeholder="Username">
                <input type="password" id="accPassword" placeholder="Password">
                <input type="text" id="accEmail" placeholder="Email (optional)">
                <input type="text" id="accProxy" placeholder="Proxy (ip:port:user:pass)">
                <button onclick="addAccount()">‚ûï Add Account</button>
                <button class="btn-danger" onclick="clearAccounts()">üóëÔ∏è Clear All</button>
            </div>
            
            <div class="accounts-grid" id="accountsList">
                <!-- Accounts will be displayed here -->
            </div>
        </div>

        <!-- Actions Panel -->
        <div id="actions" class="panel">
            <h2>Automation Actions</h2>
            <select id="actionType">
                <option value="follow">Follow Users</option>
                <option value="unfollow">Unfollow Users</option>
                <option value="like">Like Posts</option>
                <option value="comment">Comment on Posts</option>
                <option value="story">Watch Stories</option>
                <option value="direct">Send DM</option>
            </select>
            
            <textarea id="targets" placeholder="Enter targets (one per line) or post URLs"></textarea>
            <textarea id="comments" placeholder="Comments (one per line)"></textarea>
            
            <div>
                <label>Accounts to use:</label>
                <div id="accountSelection"></div>
            </div>
            
            <div>
                <label>Delay between actions (seconds):</label>
                <input type="number" id="actionDelay" value="30" min="5">
            </div>
            
            <div>
                <label>Max actions per account:</label>
                <input type="number" id="maxActions" value="50" min="1">
            </div>
            
            <button class="btn-success" onclick="startActions()">‚ñ∂Ô∏è Start Actions</button>
            <button class="btn-danger" onclick="stopActions()">‚èπÔ∏è Stop</button>
            
            <div class="log" id="actionLogs"></div>
        </div>

        <!-- Scheduler Panel -->
        <div id="scheduler" class="panel">
            <h2>Task Scheduler</h2>
            <div>
                <label>Schedule Type:</label>
                <select id="scheduleType">
                    <option value="daily">Daily</option>
                    <option value="hourly">Hourly</option>
                    <option value="specific">Specific Time</option>
                </select>
            </div>
            
            <div>
                <label>Time:</label>
                <input type="time" id="scheduleTime">
            </div>
            
            <div>
                <label>Actions to schedule:</label>
                <select multiple id="scheduledActions">
                    <option value="follow">Follow</option>
                    <option value="like">Like</option>
                    <option value="comment">Comment</option>
                </select>
            </div>
            
            <button onclick="addSchedule()">‚ûï Add Schedule</button>
            
            <div id="schedulesList"></div>
        </div>

        <!-- Proxies Panel -->
        <div id="proxies" class="panel">
            <h2>Proxy Management</h2>
            <textarea id="proxyList" placeholder="Enter proxies (format: ip:port:user:pass or ip:port)" rows="10"></textarea>
            <button onclick="addProxies()">Add Proxies</button>
            <button onclick="testProxies()">Test All Proxies</button>
            
            <div id="proxiesStatus"></div>
        </div>

        <!-- Settings Panel -->
        <div id="settings" class="panel">
            <h2>System Settings</h2>
            <div>
                <label>API Key:</label>
                <input type="text" id="apiKey" placeholder="Enter API key">
            </div>
            
            <div>
                <label>User Agent Rotation:</label>
                <select id="userAgentMode">
                    <option value="random">Random</option>
                    <option value="static">Static</option>
                </select>
            </div>
            
            <div>
                <label>Max Concurrent Accounts:</label>
                <input type="number" id="maxConcurrent" value="3" min="1" max="10">
            </div>
            
            <div>
                <input type="checkbox" id="useProxies" checked>
                <label>Use Proxies</label>
            </div>
            
            <div>
                <input type="checkbox" id="autoRotate">
                <label>Auto Rotate Accounts</label>
            </div>
            
            <button onclick="saveSettings()">üíæ Save Settings</button>
            <button onclick="exportData()">üì§ Export Data</button>
            <button onclick="importData()">üì• Import Data</button>
        </div>
    </div>

    <script>
        // System State
        let accounts = [];
        let proxies = [];
        let schedules = [];
        let isRunning = false;
        let currentJobs = [];
        
        // User Agents for rotation
        const userAgents = [
            'Mozilla/5.0 (iPhone; CPU iPhone OS 14_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0 Mobile/15E148 Safari/604.1',
            'Mozilla/5.0 (Linux; Android 10; SM-G973F) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.120 Mobile Safari/537.36',
            'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',
            'Instagram 219.0.0.12.117 Android'
        ];
        
        // Initialize
        function init() {
            loadData();
            updateStats();
            renderAccounts();
            renderAccountSelection();
        }
        
        // Panel Navigation
        function showPanel(panelId) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(panelId).classList.add('active');
            document.querySelector(`[onclick="showPanel('${panelId}')"]`).classList.add('active');
        }
        
        // Account Management
        function addAccount() {
            const username = document.getElementById('accUsername').value.trim();
            const password = document.getElementById('accPassword').value.trim();
            const proxy = document.getElementById('accProxy').value.trim();
            
            if (!username || !password) {
                logSystem('Please enter username and password', 'error');
                return;
            }
            
            const account = {
                id: Date.now(),
                username,
                password,
                email: document.getElementById('accEmail').value.trim(),
                proxy: proxy || null,
                status: 'active',
                lastUsed: null,
                actionsToday: 0,
                createdAt: new Date().toISOString(),
                cookies: null
            };
            
            accounts.push(account);
            saveData();
            renderAccounts();
            renderAccountSelection();
            updateStats();
            
            // Clear inputs
            document.getElementById('accUsername').value = '';
            document.getElementById('accPassword').value = '';
            document.getElementById('accEmail').value = '';
            document.getElementById('accProxy').value = '';
            
            logSystem(`Account ${username} added`, 'success');
            
            // Test account login
            testAccount(account.id);
        }
        
        function renderAccounts() {
            const container = document.getElementById('accountsList');
            container.innerHTML = '';
            
            accounts.forEach(account => {
                const card = document.createElement('div');
                card.className = 'account-card';
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <span class="status-indicator ${account.status === 'active' ? 'status-active' : 'status-inactive'}"></span>
                            <strong>${account.username}</strong>
                        </div>
                        <button onclick="removeAccount(${account.id})" style="background: #cc0000; padding: 5px 10px; font-size: 12px;">X</button>
                    </div>
                    <p>Actions today: ${account.actionsToday || 0}</p>
                    <p>Proxy: ${account.proxy ? '‚úì' : '‚úó'}</p>
                    <p>Added: ${new Date(account.createdAt).toLocaleDateString()}</p>
                    <button onclick="testAccount(${account.id})" style="font-size: 12px; padding: 5px;">Test</button>
                `;
                container.appendChild(card);
            });
        }
        
        function renderAccountSelection() {
            const container = document.getElementById('accountSelection');
            container.innerHTML = '';
            
            accounts.forEach(account => {
                const div = document.createElement('div');
                div.innerHTML = `
                    <input type="checkbox" id="acc_${account.id}" value="${account.id}">
                    <label for="acc_${account.id}">${account.username}</label>
                `;
                container.appendChild(div);
            });
        }
        
        function removeAccount(id) {
            accounts = accounts.filter(acc => acc.id !== id);
            saveData();
            renderAccounts();
            renderAccountSelection();
            updateStats();
            logSystem('Account removed', 'warning');
        }
        
        function clearAccounts() {
            if (confirm('Delete ALL accounts?')) {
                accounts = [];
                saveData();
                renderAccounts();
                renderAccountSelection();
                updateStats();
                logSystem('All accounts cleared', 'warning');
            }
        }
        
        function testAccount(id) {
            const account = accounts.find(acc => acc.id === id);
            if (!account) return;
            
            logSystem(`Testing account ${account.username}...`, 'info');
            
            // Simulate login test
            setTimeout(() => {
                const success = Math.random() > 0.3;
                if (success) {
                    account.status = 'active';
                    logSystem(`Account ${account.username} login successful`, 'success');
                } else {
                    account.status = 'inactive';
                    logSystem(`Account ${account.username} login failed`, 'error');
                }
                saveData();
                renderAccounts();
            }, 2000);
        }
        
        // Action Execution
        function startActions() {
            if (isRunning) {
                logSystem('Actions already running', 'warning');
                return;
            }
            
            const actionType = document.getElementById('actionType').value;
            const targets = document.getElementById('targets').value.split('\n').filter(t => t.trim());
            const comments = document.getElementById('comments').value.split('\n').filter(c => c.trim());
            const delay = parseInt(document.getElementById('actionDelay').value) * 1000;
            const maxActions = parseInt(document.getElementById('maxActions').value);
            
            if (targets.length === 0) {
                logSystem('No targets specified', 'error');
                return;
            }
            
            // Get selected accounts
            const selectedAccountIds = [];
            document.querySelectorAll('#accountSelection input:checked').forEach(cb => {
                selectedAccountIds.push(parseInt(cb.value));
            });
            
            if (selectedAccountIds.length === 0) {
                logSystem('No accounts selected', 'error');
                return;
            }
            
            isRunning = true;
            logSystem(`Starting ${actionType} actions...`, 'info');
            
            // Simulate actions
            simulateActions(actionType, targets, selectedAccountIds, delay, maxActions, comments);
        }
        
        function simulateActions(type, targets, accountIds, delay, maxActions, comments) {
            let actionsCompleted = 0;
            let accountIndex = 0;
            
            const interval = setInterval(() => {
                if (!isRunning || actionsCompleted >= maxActions || accountIndex >= accountIds.length) {
                    clearInterval(interval);
                    isRunning = false;
                    logSystem('Actions completed', 'success');
                    return;
                }
                
                const accountId = accountIds[accountIndex];
                const account = accounts.find(acc => acc.id === accountId);
                const target = targets[Math.floor(Math.random() * targets.length)];
                const comment = comments.length > 0 ? comments[Math.floor(Math.random() * comments.length)] : '';
                
                if (account && account.status === 'active') {
                    // Simulate action
                    let message = '';
                    switch(type) {
                        case 'follow':
                            message = `Following ${target}`;
                            break;
                        case 'like':
                            message = `Liking ${target}`;
                            break;
                        case 'comment':
                            message = `Commenting "${comment}" on ${target}`;
                            break;
                        default:
                            message = `Performing ${type} on ${target}`;
                    }
                    
                    const success = Math.random() > 0.2;
                    
                    if (success) {
                        account.actionsToday = (account.actionsToday || 0) + 1;
                        logSystem(`[${account.username}] ${message} ‚úì`, 'success');
                    } else {
                        logSystem(`[${account.username}] ${message} ‚úó`, 'error');
                    }
                    
                    actionsCompleted++;
                    accountIndex = (accountIndex + 1) % accountIds.length;
                    
                    saveData();
                    updateStats();
                }
            }, delay);
            
            currentJobs.push(interval);
        }
        
        function stopActions() {
            isRunning = false;
            currentJobs.forEach(interval => clearInterval(interval));
            currentJobs = [];
            logSystem('Actions stopped', 'warning');
        }
        
        // Data Management
        function saveData() {
            const data = {
                accounts,
                proxies,
                schedules,
                version: '2.0'
            };
            localStorage.setItem('instagramBotData', JSON.stringify(data));
        }
        
        function loadData() {
            const saved = localStorage.getItem('instagramBotData');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    accounts = data.accounts || [];
                    proxies = data.proxies || [];
                    schedules = data.schedules || [];
                } catch (e) {
                    console.error('Error loading data:', e);
                }
            }
        }
        
        function exportData() {
            const data = {
                accounts,
                proxies,
                schedules,
                exportedAt: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `instagram_bot_${new Date().getTime()}.json`;
            a.click();
            
            logSystem('Data exported', 'success');
        }
        
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = event => {
                    try {
                        const data = JSON.parse(event.target.result);
                        accounts = data.accounts || [];
                        proxies = data.proxies || [];
                        schedules = data.schedules || [];
                        
                        saveData();
                        renderAccounts();
                        renderAccountSelection();
                        updateStats();
                        
                        logSystem('Data imported successfully', 'success');
                    } catch (error) {
                        logSystem('Error importing data', 'error');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // Logging
        function logSystem(message, type = 'info') {
            const logDiv = document.getElementById('systemLogs');
            const logLine = document.createElement('div');
            logLine.className = `log-line ${type}`;
            
            const timestamp = new Date().toLocaleTimeString();
            logLine.textContent = `[${timestamp}] ${message}`;
            
            logDiv.appendChild(logLine);
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function updateStats() {
            document.getElementById('totalAccounts').textContent = accounts.length;
            const active = accounts.filter(a => a.status === 'active').length;
            document.getElementById('activeAccounts').textContent = active;
            
            const totalActions = accounts.reduce((sum, acc) => sum + (acc.actionsToday || 0), 0);
            document.getElementById('todayActions').textContent = totalActions;
            
            const successRate = accounts.length > 0 ? Math.round((active / accounts.length) * 100) : 0;
            document.getElementById('successRate').textContent = `${successRate}%`;
        }
        
        // Proxies
        function addProxies() {
            const proxyText = document.getElementById('proxyList').value;
            const lines = proxyText.split('\n').filter(p => p.trim());
            
            lines.forEach(line => {
                const parts = line.split(':');
                if (parts.length >= 2) {
                    const proxy = {
                        host: parts[0],
                        port: parts[1],
                        username: parts[2] || null,
                        password: parts[3] || null,
                        status: 'unknown'
                    };
                    proxies.push(proxy);
                }
            });
            
            saveData();
            logSystem(`Added ${lines.length} proxies`, 'success');
            document.getElementById('proxyList').value = '';
        }
        
        // Initialize on load
        window.onload = init;
        
        // Real Instagram API Simulation (Educational Purposes)
        class InstagramSimulator {
            constructor(username, password, proxy = null) {
                this.username = username;
                this.password = password;
                this.proxy = proxy;
                this.session = null;
                this.loggedIn = false;
            }
            
            async login() {
                // Simulated login
                return new Promise((resolve) => {
                    setTimeout(() => {
                        this.loggedIn = Math.random() > 0.3;
                        resolve(this.loggedIn);
                    }, 2000);
                });
            }
            
            async follow(userId) {
                if (!this.loggedIn) return false;
                // Simulated follow
                await this.delay(1000);
                return Math.random() > 0.2;
            }
            
            async like(postId) {
                if (!this.loggedIn) return false;
                // Simulated like
                await this.delay(800);
                return Math.random() > 0.1;
            }
            
            async comment(postId, text) {
                if (!this.loggedIn) return false;
                // Simulated comment
                await this.delay(1200);
                return Math.random() > 0.3;
            }
            
            async delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }
    </script>
</body>
</html>
